window.r7 = window.r7 || {};

/**
 * Classe responsável pela administração das publicidades (exceto o intextvideo)
 * @author Bruno Bulnes
 */
window.r7.ads = (function () {

  function __setGoogletag(slotDefs) {
    googletag.cmd.push(function () {
      var slot = googletag
        .defineSlot(slotDefs.hash, slotDefs.sizes)
        .addService(googletag.pubads());

      if (slotDefs.sizes == 'fluid') {
        slot.setTargeting('pos', 'native');
      } else if (slotDefs.pos) {
        slot.setTargeting('pos', slotDefs.pos);
      }

      if (slotDefs.context) {
        slot.setTargeting('context', slotDefs.context);
      }

      for (var i = 0; i < slotDefs.others.length; i++) {
        var other = slotDefs.others[i];
        slot.setTargeting(other.name, other.value);
      }

      window.r7.tailTarget.tailTargetWithGPT(slot);

      var slotId = slot.getSlotElementId(); // auto-generated by GPT
      var script = slotDefs.script;
      window.r7.slot.createAdSlot(script, slotId);

      // Register the slot as ready and fetch an ad.
      googletag.display(slot);
    });
  };

  function __defineAd() {
    var slotDefs = window.r7.slot.getSlotDefinitions();
    if (!slotDefs) {
      return false;
    }

    if (slotDefs.sizes === 'intextvideo') {
      window.r7.intextvideo.load(slotDefs);
    } else {
      __setGoogletag(slotDefs);
    }

    // chama o carregamento da publicidade 
    // até todas estiverem visíveis
    __defineAd();
  }

  function load() {
    var interval, r7 = window.r7;
    interval = setInterval(function () {
      var adv = r7.adv.isReady();
      var tailTarget = r7.tailTarget.isReady();

      if (tailTarget && adv) {
        __defineAd();
        clearInterval(interval);
      }
    }, 0);
  };

  return {
    load: load,
  };
})();
window.r7 = window.r7 || {};

/**
 * Classe responsável pela administração da biblioteca ADV
 * @author Bruno Bulnes
 */
window.r7.adv = (function () {
  var url = 'https://adv.r7.com//script/async?href=' + window.location.href.split('?')[0];

  function __configureGoogleTag() {
    window.googletag = window.googletag || {};
    window.googletag.cmd = window.googletag.cmd || [];

    googletag.cmd.push(function () {
      // Enable SRA to honor competetive exclusions and roadblocks.
      googletag.pubads().enableSingleRequest();
      // Enable services
      googletag.enableServices();
    });
  };

  function isReady() {
    return typeof r7ad !== typeof undefined;
  };

  function load() {
    var script = document.querySelector("script[src='" + url + "']")
    if (script) {
      return false;
    }

    __configureGoogleTag();
    var callback = 'window.parent.r7ad=r7ad;';
    window.r7.fif.setSourceURL(url).createFif(callback);
  };

  return {
    load: load,
    isReady: isReady,
  };
})();
window.r7 = window.r7 || {};

/**
 * Friendly iFrame Helper
 * Recurso indicado para carregamento performático de scripts de terceiros
 * @author Bruno Bulnes
 * @example 
 *  window.r7.fif
 *    .setSourceURL('https://adv.r7.com//script/async?href=https://www.r7.com/')
 *    .createFif('window.parent.r7ad=r7ad;');
 *  # => window.r7ad.hash
 */
window.r7.fif = (function () {
  var url, iframe;

  function __createIframe() {
    var resetIframeStyle = 'width: 0; height: 0; border: 0';
    iframe = document.createElement('iframe');
    (iframe.frameElement || iframe).style.cssText = resetIframeStyle;
    iframe.src = 'javascript:false';

    document.body.appendChild(iframe);
  };

  function createFif(stringCallback) {
    __createIframe();

    var doc = iframe.contentWindow.document;
    doc.open().write('<body onload="' +
      'var js = document.createElement(\'script\');' +
      'js.src = \'' + url + '\';' +
      'js.onload=function(){ ' + stringCallback + ' };' +
      'document.body.appendChild(js);">');
    doc.close();
  };

  function setSourceURL(path) {
    url = path;
    return this;
  };

  return {
    setSourceURL: setSourceURL,
    createFif: createFif,
  };
})();
window.r7 = window.r7 || {};

/**
 * Classe responsável para inserção da biblioteca GPT
 * @author Bruno Bulnes
 */
window.r7.gpt = (function () {
  var url = 'https://securepubads.g.doubleclick.net/tag/js/gpt.js';

  function load() {
    var script = document.querySelector("script[src='" + url + "']")
    if (script || (window.googletag && googletag.apiReady)) {
      return false;
    }
    var gpt = document.createElement('script');
    gpt.src = url;
    gpt.async = true;
    document.body.appendChild(gpt);
  };

  return {
    load: load,
  };
})();
window.r7 = window.r7 || {};

/**
 * Classe responsável pela publicidade IntextVideo
 * @author Bruno Bulnes
 * @description 
 *  O intextvideo nada mais é do que um vídeo (publicidade) que aparece 
 *  entre os parágrafos de um artigo.
 *  
 *  Esse link serviu como base para esta classe: 
 *  https://developers.google.com/interactive-media-ads/docs/sdks/html5/client-side 
 *  (porém, perceba que o artigo acima é sobre a publicidade em um vídeo, ou seja, 
 *   o conceito intextvideo é uma adaptação desse tipo de publicidade)
 */
window.r7.intextvideo = (function () {
  var adsLoaded = false;
  var adContainer;
  var adDisplayContainer;
  var adsLoader;
  var adsManager;
  var targetId = 'video-intext-r7';
  var width = 640;
  var height = 360;
  var stepTransform = 20;
  var timer = null;
  var scrollListener = null;
  var slotConf = {};
  var header;
  var btnVolume;

  function __initializeIMA() {
    __updateDimensions();
    __defaultContainerConfig();

    adDisplayContainer = new google.ima.AdDisplayContainer(adContainer);
    adsLoader = new google.ima.AdsLoader(adDisplayContainer);

    adsLoader.addEventListener(
      google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, __onAdsManagerLoaded, false);
    adsLoader.addEventListener(
      google.ima.AdErrorEvent.Type.AD_ERROR, __onAdComplete, false);
    
    var adsRequest = new google.ima.AdsRequest();
    adsRequest.adTagUrl = window.r7.utils.getTagUrl(slotConf);

    adsRequest.linearAdSlotWidth = width;
    adsRequest.linearAdSlotHeight = height;
    adsRequest.nonLinearAdSlotWidth = width;
    adsRequest.nonLinearAdSlotHeight = height / 3;

    adsLoader.requestAds(adsRequest);
  }

  function __loadAds() {
    if (!window.r7.utils.isInViewport(adContainer)) { return; }

    window.removeEventListener('scroll', scrollListener);

    if (adsLoaded) { return; }
    adsLoaded = true;

    adDisplayContainer.initialize();
    try {
      __increaseContainer();
      __updateDimensions();

      adsManager.init(width, height, google.ima.ViewMode.NORMAL);
      adsManager.start();
    } catch (unused) { }
  }

  function __updateDimensions() {
    width = adContainer.clientWidth;
    height = Math.ceil(width * 0.5625); // preservar o aspect ratio 16:9
  }

  function __createHeader() {
    header = document.createElement('header');
    header.style.cssText = [
      'display: flex',
      'align-items: center',
      'justify-content: space-between',
      'margin-top: -28px',
    ].join(';');

    var pubs = document.createElement('span');
    pubs.textContent = 'Publicidade';
    pubs.style.color = '#95a5a6';

    __createBtnVolume();
    header.appendChild(pubs);
    header.appendChild(btnVolume);

    adContainer.appendChild(header);
  };

  function __createBtnVolume() {
    var cssRules = [
      'border: none',
      'padding: 0',
      'margin: 0',
      'cursor: pointer',
      'height: 20px',
      'width: 20px',
    ].join(';');

    btnVolume = document.createElement('img');
    btnVolume.src = window.r7.utils.getMuteIconBase64();
    btnVolume.alt = 'Botão para controlar o volume da publicidade';
    btnVolume.setAttribute('data-clicked', false);
    btnVolume.style.cssText = cssRules;
    btnVolume.onclick = __setVolume;
  };

  function __setVolume(btn) {
    btn.preventDefault();

    var target = btn.target;
    var clicked = target.getAttribute('data-clicked') === 'true';

    if (!clicked && adsManager) {
      target.src = window.r7.utils.getSpeakerIconBase64();
      adsManager.setVolume(1);
    } else if (adsManager) {
      target.src = window.r7.utils.getMuteIconBase64();
      adsManager.setVolume(0);
    }

    btn.target.setAttribute('data-clicked', !clicked);
  };

  function __defaultContainerConfig() {
    var cssRules = [
      'display: block',
      'height: 0',
      'max-width: ' + width + 'px',
      'overflow: hidden',
      'text-align: center',
      'padding: 0',
      'margin: 0',
      'float: left',
    ].join(';');

    adContainer.style.cssText = cssRules;
  }

  function __increaseContainer() {
    adContainer.style.float = 'none';
    adContainer.style.marginBottom = '48px';
    adContainer.style.marginTop = '20px';
    adContainer.style.paddingTop = '28px';
    
    var i = 0;
    var interval = setInterval(function () {
      if (i >= height) {
        adContainer.style.height = height + 'px';
        adContainer.style.display = 'block';
        clearInterval(interval);
        return false;
      }
      adContainer.style.height = i + 'px';
      i += stepTransform;
    }, 0);
  }

  function __decreaseContainer() {
    adContainer.style.marginBottom = '0';
    adContainer.style.paddingTop = '0';

    var i = height;
    var interval = setInterval(function () {
      if (i <= 0) {
        adContainer.style.height = '0';
        adContainer.style.display = 'none';
        clearInterval(interval);
        return false;
      }
      adContainer.style.height = i + 'px';
      i -= (stepTransform / 2);
    }, 0);
  }

  function __onAdsManagerLoaded(adsManagerLoadedEvent) {
    adsManager = adsManagerLoadedEvent.getAdsManager({});
    adsManager.addEventListener(google.ima.AdEvent.Type.STARTED, __onAdStarted);
    adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, __onAdComplete);
    adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE, __onAdComplete);
    adsManager.addEventListener(google.ima.AdEvent.Type.CLICK, __onAdComplete);
    adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED, __onAdComplete);
  }

  function __onAdStarted() {
    if (adsManager) {
      adsManager.setVolume(0);
    }
  };

  function __onAdComplete() {
    if (adsManager) {
      adsManager.destroy();
    }
    __decreaseContainer();
  }

  function __loadIMA() {
    var url = '//imasdk.googleapis.com/js/sdkloader/ima3.js';

    var loaded = document.querySelector('script[src="' + url + '"]');
    if (!loaded) {
      var script = document.createElement('script');
      script.src = url;
      document.body.appendChild(script);
    }
  }

  function __scrollListener() {
    scrollListener = function () {
      if (timer !== null) { clearTimeout(timer); }
      timer = setTimeout(__loadAds, 500);
    };

    window.addEventListener('scroll', scrollListener);
  }

  function __containerListener() {
    window.addEventListener('resize', function (event) {
      __updateDimensions();
      if (adsManager) {
        adsManager.resize(width, height, google.ima.ViewMode.NORMAL);
      }
    });
  }

  function load(slotDefs) {
    slotConf = slotDefs;
    targetId = slotConf.target || targetId;
    adContainer = document.getElementById(targetId);
    if (!adContainer) { return; }

    __loadIMA();
    var interval = setInterval(function () {
      if (window.google && window.google.ima) {
        __createHeader();
        __initializeIMA();
        __scrollListener();
        __containerListener();
        clearInterval(interval);
      }
    }, 0);
  };

  return {
    load: load,
  };
})();
window.r7 = window.r7 || {};

/**
 * Classe responsável por administrar e criar os slots, 
 * onde as publicidades serão exibidas
 * @author Bruno Bulnes
 */
window.r7.slot = (function () {

  function __selectContainer() {
    var select = 'script[data-vendor="r7.com"]:not(.already-visited)';
    var script = document.querySelector(select);
    if (script) {
      script.classList.add('already-visited');
    }
    return script;
  };

  function createAdSlot(script, id) {
    try {
      var divtarget = document.createElement('div');
      divtarget.id = id

      script.parentNode.insertBefore(divtarget, script);
      return divtarget;
    } catch (unused) { }
  };

  function getSlotDefinitions() {
    var script = __selectContainer();
    if (!script) {
      return false;
    }

    var hash = script.getAttribute('data-hash') || window.r7ad.hash;

    var sizes = script.getAttribute('data-sizes');
    if (['fluid', 'intextvideo'].indexOf(sizes.toLowerCase()) === -1) {
      sizes = JSON.parse(sizes);
    }

    var pos = script.getAttribute('data-pos');
    var context = script.getAttribute('data-context');

    var nofollow = script.getAttribute('data-nofollow');

    // atributo especial para o intextvideo
    var target = script.getAttribute('data-target');

    var others = [];
    for (var i = 0; i < script.attributes.length - 1; i++) {
      var attr = script.attributes[i];

      // filtra os atributos não data-*
      if (attr.name.indexOf('data-') === -1) { continue; }

      // filtra os atributos data-* default
      var dataAttrs = ['data-hash', 'data-sizes', 'data-vendor', 'data-pos', 'data-context', 'data-nofollow', 'data-target'];
      if (dataAttrs.indexOf(attr.name) !== -1) {
        continue;
      }

      others.push({
        name: attr.name.replace('data-', ''),
        value: attr.value
      });
    }

    return {
      'sizes': sizes,
      'pos': pos,
      'context': context,
      'others': others,
      'hash': hash,
      'nofollow': nofollow,
      'script': script,
      'target': target
    };
  };

  return {
    createAdSlot: createAdSlot,
    getSlotDefinitions: getSlotDefinitions,
  };

})();

window.r7 = window.r7 || {};

/**
 * Classe responsável para administração da biblioteca TailTarget
 * @author Bruno Bulnes
 */
window.r7.tailTarget = (function () {
  var ready = false;
  var url = 'https://scs.r7.com/tailtarget/profiles.js';

  function __configureProfile() {
    window._ttprofiles = window._ttprofiles || [];
    _ttprofiles.profiles = [];
    _ttprofiles.push(['_setAccount', 'TT-9964-3']);
    _ttprofiles.push(['_enableServices']);
  };

  function setTargeting() {
    var _ttprofiles = window._ttprofiles || [];
    var tags = {
      age: _ttprofiles.getAge,
      gender: _ttprofiles.getGender,
      cluster: _ttprofiles.getProfiles,
      subjects: _ttprofiles.getSubjects,
      team: _ttprofiles.getTeam,
      sclass: _ttprofiles.getSocialClass,
      msegments: _ttprofiles.getMicrosegments,
      customaud: _ttprofiles.getCustomAudience,
    };
    var custom = "";

    for (var key in tags) {
      if (tags.hasOwnProperty(key)) {
        custom += key + "=" + tags[key] + "&";
      }
    }

    return encodeURIComponent(custom);
  }

  function tailTargetWithGPT(slot) {
    if (!slot) { return false; }

    slot.setTargeting('age', _ttprofiles.getAge);
    slot.setTargeting('gender', _ttprofiles.getGender);
    slot.setTargeting('cluster', _ttprofiles.getProfiles);
    slot.setTargeting('subjects', _ttprofiles.getSubjects);
    slot.setTargeting('team', _ttprofiles.getTeam);
    slot.setTargeting('sclass', _ttprofiles.getSocialClass);
    slot.setTargeting('msegments', _ttprofiles.getMicrosegments);
    slot.setTargeting('customaud', _ttprofiles.getCustomAudience);
  };

  function setReadyState() {
    ready = true;
    __configureProfile();
  };

  function load() {
    var script = document.querySelector("script[src='" + url + "']");
    if (script) {
      return false;
    }

    var callback = [
      'window.parent._ttprofiles=_ttprofiles;',
      'window.parent.r7.tailTarget.setReadyState();'
    ].join('');
    window.r7.fif.setSourceURL(url).createFif(callback);
  };

  function isReady() {
    return ready;
  };

  return {
    load: load,
    isReady: isReady,
    setReadyState: setReadyState,
    tailTargetWithGPT: tailTargetWithGPT,
    setTargeting: setTargeting,
  };
})();

window.r7 = window.r7 || {};

/**
 * Classe com diversas funcionalidades compartilhadas
 * @author Bruno Bulnes
 */
window.r7.utils = (function () {

  function __getQATagUrl() {
    return 'https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dskippablelinear&correlator=';
  };

  function __getProdTagUrl(slotConf) {
    var timestamp = Math.floor(Date.now() / 1000);
    var tailtarget = window.r7.tailTarget.setTargeting();

    return 'https://pubads.g.doubleclick.net/gampad/ads?' +
    'sz=780x432&' +
    'iu=' + slotConf.hash + '&' +
    'gdfp_req=1&env=vp&' +
    'output=xml_vast4&' +
    'unviewed_position_start=1&' +
    'url=' + document.referrer + '&' +
    'correlator=' + timestamp + '&' +
    'cust_params=pos%3Dintextvideo%26' + tailtarget + '&' +
    'ad_rule=0';
  };

  function getTagUrl(slotConf) {
    var hostName = window.location.hostname;

    var isIPHost = !isNaN(parseInt(hostName));
    var isLocalH = hostName === 'localhost';
    var isQAHost = hostName.indexOf('ir7.com.br') !== -1;
    if (isLocalH || isIPHost || isQAHost) {
      return __getQATagUrl();
    }
    return __getProdTagUrl(slotConf);
  };

  // Original:
  // https://upload.wikimedia.org/wikipedia/commons/2/21/Speaker_Icon.svg
  function getSpeakerIconBase64() {
    return 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4wIiAgd2lkdGg9IjUwMCIgaGVpZ2h0PSI1MDAiIHZpZXdCb3g9IjAgMCA3NSA3NSI+DQo8cGF0aCBkPSJNMzkuMzg5LDEzLjc2OSBMMjIuMjM1LDI4LjYwNiBMNiwyOC42MDYgTDYsNDcuNjk5IEwyMS45ODksNDcuNjk5IEwzOS4zODksNjIuNzUgTDM5LjM4OSwxMy43Njl6Ig0Kc3R5bGU9InN0cm9rZTojMTExO3N0cm9rZS13aWR0aDo1O3N0cm9rZS1saW5lam9pbjpyb3VuZDtmaWxsOiMxMTE7Ig0KLz4NCjxwYXRoIGQ9Ik00OCwyNy42YTE5LjUsMTkuNSAwIDAgMSAwLDIxLjRNNTUuMSwyMC41YTMwLDMwIDAgMCAxIDAsMzUuNk02MS42LDE0YTM4LjgsMzguOCAwIDAgMSAwLDQ4LjYiIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMxMTE7c3Ryb2tlLXdpZHRoOjU7c3Ryb2tlLWxpbmVjYXA6cm91bmQiLz4NCjwvc3ZnPg==';
  };

  // Original: 
  // https://upload.wikimedia.org/wikipedia/commons/3/3f/Mute_Icon.svg
  function getMuteIconBase64() {
    return 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgdmVyc2lvbj0iMS4wIgogICBpZD0ibGF5ZXIxIgogICB3aWR0aD0iNDAwcHQiCiAgIGhlaWdodD0iNDAwcHQiCiAgIHZpZXdCb3g9IjAgMCA3NSA3NSIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMC40OC4zLjEgcjk4ODYiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik11dGVfSWNvbi5zdmciPjxkZWZzCiAgIGlkPSJkZWZzMzAwNyIgLz48c29kaXBvZGk6bmFtZWR2aWV3CiAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgIGJvcmRlcm9wYWNpdHk9IjEiCiAgIG9iamVjdHRvbGVyYW5jZT0iMTAiCiAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICBndWlkZXRvbGVyYW5jZT0iMTAiCiAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwIgogICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiCiAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjEwMjgiCiAgIGlkPSJuYW1lZHZpZXczMDA1IgogICBzaG93Z3JpZD0iZmFsc2UiCiAgIHNob3dndWlkZXM9InRydWUiCiAgIGlua3NjYXBlOmd1aWRlLWJib3g9InRydWUiCiAgIGlua3NjYXBlOnpvb209IjAuNjQ5IgogICBpbmtzY2FwZTpjeD0iLTI4Mi40MTk2IgogICBpbmtzY2FwZTpjeT0iMTcxLjgzNDgiCiAgIGlua3NjYXBlOndpbmRvdy14PSItOCIKICAgaW5rc2NhcGU6d2luZG93LXk9Ii04IgogICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIgogICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJnMSIKICAgaW5rc2NhcGU6c25hcC1zbW9vdGgtbm9kZXM9ImZhbHNlIgogICBpbmtzY2FwZTpvYmplY3QtcGF0aHM9ImZhbHNlIj48c29kaXBvZGk6Z3VpZGUKICAgICBvcmllbnRhdGlvbj0iMCwxIgogICAgIHBvc2l0aW9uPSI0Mi40OTE3NzksMzI2Ljg1OTg0IgogICAgIGlkPSJndWlkZTMwMDkiIC8+PHNvZGlwb2RpOmd1aWRlCiAgICAgb3JpZW50YXRpb249IjAsMSIKICAgICBwb3NpdGlvbj0iMTE4LjY0NDA3LDE2NC44NjkwMyIKICAgICBpZD0iZ3VpZGUzMDExIiAvPjxzb2RpcG9kaTpndWlkZQogICAgIG9yaWVudGF0aW9uPSIxLDAiCiAgICAgcG9zaXRpb249IjMyNC4zNDUxNSwxOTQuNTMwMDUiCiAgICAgaWQ9Imd1aWRlMzAwNSIgLz48c29kaXBvZGk6Z3VpZGUKICAgICBvcmllbnRhdGlvbj0iMSwwIgogICAgIHBvc2l0aW9uPSI0NjIuNjM0ODIsMTcwLjY0NzE1IgogICAgIGlkPSJndWlkZTMwMDciIC8+PC9zb2RpcG9kaTpuYW1lZHZpZXc+PG1ldGFkYXRhCiAgIGlkPSJtZXRhZGF0YTEiPjxyZGY6UkRGPjxjYzpXb3JrCiAgICAgICByZGY6YWJvdXQ9IiI+PGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+PGRjOnR5cGUKICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGUgLz48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGcKICAgaWQ9ImcxIj48cG9seWdvbgogICBpZD0icG9seWdvbjEiCiAgIHBvaW50cz0iMzkuMzg5LDEzLjc2OSAyMi4yMzUsMjguNjA2IDYsMjguNjA2IDYsNDcuNjk5IDIxLjk4OSw0Ny42OTkgMzkuMzg5LDYyLjc1IDM5LjM4OSwxMy43NjkiCiAgIHN0eWxlPSJzdHJva2U6IzExMTExMTtzdHJva2Utd2lkdGg6NTtzdHJva2UtbGluZWpvaW46cm91bmQ7ZmlsbDojMTExMTExOyIgLz4KCjxwYXRoCiAgIGlkPSJwYXRoMzAwMyIKICAgZD0iTSA0OC42NTE3NzIsNTAuMjY5NjQ2IDY5LjM5NTIyMywyNS45NzEwMjQiCiAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMxMTExMTE7c3Ryb2tlLXdpZHRoOjU7c3Ryb2tlLWxpbmVjYXA6cm91bmQiCiAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CjxwYXRoCiAgIGlkPSJwYXRoMzAwMy0xIgogICBkPSJNIDY5LjM5NTIyMyw1MC4yNjk2NDYgNDguNjUxNzcyLDI1Ljk3MTAyNCIKICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzExMTExMTtzdHJva2Utd2lkdGg6NTtzdHJva2UtbGluZWNhcDpyb3VuZCIKICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIKICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz48L2c+Cjwvc3ZnPg==';
  };

  // Verifica se o elemento está no viewport (área visível) do usuário
  function isInViewport(el) {
    if (!el) { return; }

    var distanceLoad = 0;

    var rect = el.getBoundingClientRect();

    var rectTest = rect.bottom > 0 && rect.right > 0;
    var rectLeft = rect.left < (window.innerWidth || document.documentElement.clientWidth);
    var rectTop = (rect.top - distanceLoad) < (window.innerHeight || document.documentElement.clientHeight);

    return rectTest && rectLeft && rectTop;
  }

  return {
    getMuteIconBase64: getMuteIconBase64,
    getSpeakerIconBase64: getSpeakerIconBase64,
    getTagUrl: getTagUrl,
    isInViewport: isInViewport,
  };

})();
window.r7 = window.r7 || {};
window.r7.alreadyStarted = false;

window.r7.main = (function () {

  function start() {
    if (window.r7.alreadyStarted) {
      return false;
    }
    window.r7.alreadyStarted = true;

    window.r7.gpt.load();
    window.r7.tailTarget.load();
    window.r7.adv.load();
    window.r7.ads.load();
  };

  return {
    start: start,
  };
})();

window.removeEventListener('load', window.r7.main.start);

if (document.readyState === 'complete') {
  window.r7.main.start();
}
else {
  window.addEventListener('load', window.r7.main.start);
}
